Дерево отрезков для запросов и обновлений на диапазонах за O(log n). Каждый узел хранит агрегированную информацию о своём сегменте - сумму, минимум, максимум. Поддерживает lazy propagation для массовых обновлений отрезков. Универсальное решение для range queries.
